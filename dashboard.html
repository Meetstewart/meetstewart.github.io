<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Stewart Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/HB0N0/AvataaarsJs@main/avataaars.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
            min-height: 100vh;
            color: #fff;
        }
        
        /* Beta Banner */
        .beta-banner {
            background: linear-gradient(90deg, #d4af37, #f4d03f, #d4af37);
            background-size: 200% 100%;
            animation: shimmer 3s ease-in-out infinite;
            color: #000;
            text-align: center;
            padding: 12px 20px;
            padding-top: max(12px, env(safe-area-inset-top));
            font-weight: 600;
            font-size: 0.95rem;
            letter-spacing: 0.3px;
        }
        
        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .beta-banner strong {
            font-weight: 800;
            text-transform: uppercase;
        }
        
        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 24px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid rgba(212,175,55,0.2);
        }
        
        .stats-bar .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .stats-bar .logo .bot-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            overflow: hidden;
        }
        
        .stats-bar .logo .bot-avatar svg {
            width: 100%;
            height: 100%;
        }
        
        /* View Selector Dropdown */
        .view-selector {
            position: relative;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .view-selector-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(212,175,55,0.1);
            border: 1px solid rgba(212,175,55,0.3);
            color: #d4af37;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .view-selector-btn:hover {
            background: rgba(212,175,55,0.2);
        }
        
        .view-selector-btn .arrow {
            font-size: 0.7rem;
            transition: transform 0.2s;
        }
        
        .view-selector.open .view-selector-btn .arrow {
            transform: rotate(180deg);
        }
        
        .view-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            margin-top: 8px;
            background: #1a1a2e;
            border: 1px solid rgba(212,175,55,0.3);
            border-radius: 12px;
            overflow: hidden;
            min-width: 180px;
            display: none;
            z-index: 1000;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }
        
        .view-selector.open .view-dropdown {
            display: block;
        }
        
        .view-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .view-option:hover {
            background: rgba(212,175,55,0.1);
        }
        
        .view-option.active {
            background: rgba(212,175,55,0.15);
            color: #d4af37;
        }
        
        .view-option .icon {
            font-size: 1.1rem;
        }
        
        .stats-items {
            display: flex;
            gap: 32px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: #d4af37;
        }
        
        .stat-label {
            font-size: 0.7rem;
            color: rgba(255,255,255,0.6);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .upgrade-btn {
            background: linear-gradient(135deg, #d4af37, #b8960c);
            color: #000;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
        }
        
        /* Main Layout */
        .main-container {
            display: flex;
            height: calc(100vh - 100px); /* Account for beta banner + stats bar */
        }
        
        /* View Containers */
        .view-container {
            display: none;
            width: 100%;
            height: 100%;
        }
        
        .view-container.active {
            display: flex;
        }
        
        /* Stewart Area - 2/3 */
        .stewart-area {
            flex: 2;
            display: flex;
            flex-direction: column;
            padding: 24px;
            border-right: 1px solid rgba(212,175,55,0.1);
        }
        
        .stewart-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .stewart-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #d4af37, #b8960c);
            padding: 3px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .stewart-avatar:hover {
            transform: scale(1.05);
        }
        
        .stewart-avatar-inner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: #1a1a2e;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .stewart-avatar-inner svg {
            width: 90%;
            height: 90%;
        }
        
        .stewart-info h1 {
            font-size: 1.5rem;
            margin-bottom: 4px;
        }
        
        .stewart-info p {
            color: rgba(255,255,255,0.6);
            font-size: 0.9rem;
        }
        
        .customize-btn {
            margin-left: auto;
            background: rgba(212,175,55,0.1);
            border: 1px solid rgba(212,175,55,0.3);
            color: #d4af37;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        
        .customize-btn:hover {
            background: rgba(212,175,55,0.2);
        }
        
        /* Chat/Response Area */
        .chat-area {
            flex: 1;
            background: rgba(0,0,0,0.2);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .messages {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }
        
        .message {
            margin-bottom: 16px;
            display: flex;
            flex-direction: column;
        }
        
        .message.user {
            align-items: flex-end;
        }
        
        .message-bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .message.bot .message-bubble {
            background: rgba(212,175,55,0.15);
            border: 1px solid rgba(212,175,55,0.2);
            border-bottom-left-radius: 4px;
        }
        
        .message.user .message-bubble {
            background: linear-gradient(135deg, #d4af37, #b8960c);
            color: #000;
            border-bottom-right-radius: 4px;
        }
        
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(212,175,55,0.1);
        }
        
        .quick-action {
            background: rgba(212,175,55,0.1);
            border: 1px solid rgba(212,175,55,0.2);
            color: rgba(255,255,255,0.8);
            padding: 8px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .quick-action:hover {
            background: rgba(212,175,55,0.2);
            border-color: rgba(212,175,55,0.4);
        }
        
        /* Cards Sidebar - 1/3 */
        .cards-sidebar {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .card {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(212,175,55,0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 16px;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .card-header:hover {
            background: rgba(212,175,55,0.05);
        }
        
        .card-header h3 {
            font-size: 0.95rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .card-toggle {
            color: rgba(255,255,255,0.4);
            font-size: 0.8rem;
            transition: transform 0.3s;
        }
        
        .card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .card.expanded .card-content {
            max-height: 500px;
        }
        
        .card.expanded .card-toggle {
            transform: rotate(180deg);
        }
        
        .card-inner {
            padding: 0 16px 16px;
        }
        
        .schedule-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .schedule-item:last-child {
            border-bottom: none;
        }
        
        .schedule-time {
            font-size: 0.8rem;
            color: #d4af37;
            min-width: 70px;
        }
        
        .schedule-title {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.8);
        }
        
        .schedule-item.current {
            background: rgba(212,175,55,0.1);
            margin: 0 -16px;
            padding: 8px 16px;
            border-radius: 6px;
        }
        
        /* Project styles */
        .project-item {
            margin-bottom: 12px;
        }
        
        .project-item:last-child {
            margin-bottom: 0;
        }
        
        .project-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
        }
        
        .project-name {
            font-size: 0.85rem;
        }
        
        .project-progress {
            font-size: 0.8rem;
            color: #d4af37;
        }
        
        .progress-bar {
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #d4af37, #b8960c);
            border-radius: 2px;
        }
        
        /* Task styles */
        .task-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 6px 0;
        }
        
        .task-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(212,175,55,0.4);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .task-checkbox.checked {
            background: #d4af37;
            border-color: #d4af37;
        }
        
        .task-checkbox.checked::after {
            content: '‚úì';
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .task-text {
            font-size: 0.85rem;
        }
        
        .task-text.completed {
            text-decoration: line-through;
            color: rgba(255,255,255,0.4);
        }
        
        /* Activity styles */
        .activity-item {
            display: flex;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-icon {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(212,175,55,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            flex-shrink: 0;
        }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-text {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.8);
        }
        
        .activity-time {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.4);
        }
        
        /* Input Bar */
        .input-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 16px 24px;
            background: linear-gradient(to top, rgba(15,15,35,0.98), rgba(15,15,35,0.9));
            border-top: 1px solid rgba(212,175,55,0.1);
        }
        
        .input-container {
            display: flex;
            align-items: center;
            gap: 12px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .input-field {
            flex: 1;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(212,175,55,0.2);
            border-radius: 24px;
            padding: 12px 20px;
            color: #fff;
            font-size: 0.95rem;
            outline: none;
            transition: border-color 0.2s;
        }
        
        .input-field:focus {
            border-color: #d4af37;
        }
        
        .input-field::placeholder {
            color: rgba(255,255,255,0.4);
        }
        
        .voice-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, #d4af37, #b8960c);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: transform 0.2s;
        }
        
        .voice-btn:hover {
            transform: scale(1.05);
        }
        
        /* ===== CALENDAR VIEW ===== */
        /* Calendar Tabs */
        .calendar-tabs {
            display: flex;
            gap: 5px;
        }
        .cal-tab {
            padding: 8px 20px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 20px;
            color: rgba(255,255,255,0.7);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        .cal-tab:hover {
            background: rgba(255,255,255,0.15);
        }
        .cal-tab.active {
            background: linear-gradient(135deg, #d4af37, #f4d03f);
            color: #000;
            font-weight: 600;
        }
        .cal-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        .cal-tab-content.active {
            display: block;
        }
        
        /* Today Banner */
        .today-banner {
            background: linear-gradient(135deg, rgba(212,175,55,0.2), rgba(244,208,63,0.1));
            border: 1px solid rgba(212,175,55,0.3);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        .today-day {
            display: block;
            font-size: 28px;
            font-weight: 700;
            color: #d4af37;
        }
        .today-full {
            display: block;
            font-size: 16px;
            color: rgba(255,255,255,0.7);
            margin-top: 5px;
        }
        
        /* Today Events List */
        .today-events-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .today-event-card {
            background: rgba(255,255,255,0.08);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            gap: 15px;
            align-items: flex-start;
            border-left: 4px solid #d4af37;
        }
        .today-event-card.past {
            opacity: 0.5;
            border-left-color: rgba(255,255,255,0.3);
        }
        .event-time-block {
            text-align: center;
            min-width: 60px;
        }
        .event-time {
            font-size: 18px;
            font-weight: 600;
            color: #d4af37;
        }
        .event-ampm {
            font-size: 12px;
            color: rgba(255,255,255,0.5);
        }
        .event-details {
            flex: 1;
        }
        .event-title-main {
            font-size: 16px;
            font-weight: 600;
            color: #fff;
            margin-bottom: 5px;
        }
        .event-meta {
            font-size: 13px;
            color: rgba(255,255,255,0.6);
        }
        .no-events-message {
            text-align: center;
            padding: 60px 20px;
            color: rgba(255,255,255,0.5);
        }
        .no-events-message span {
            font-size: 48px;
            display: block;
            margin-bottom: 10px;
        }
        
        /* Week View */
        .week-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .week-nav-btn {
            padding: 8px 16px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s;
        }
        .week-nav-btn:hover {
            background: rgba(212,175,55,0.3);
        }
        #weekRangeLabel {
            font-size: 18px;
            font-weight: 600;
            color: #d4af37;
        }
        .week-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .week-day-row {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        .week-day-row.today {
            background: rgba(212,175,55,0.15);
            border: 1px solid rgba(212,175,55,0.3);
        }
        .week-day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: rgba(255,255,255,0.05);
        }
        .week-day-name {
            font-weight: 600;
            color: #fff;
        }
        .week-day-row.today .week-day-name {
            color: #d4af37;
        }
        .week-day-date {
            color: rgba(255,255,255,0.5);
            font-size: 14px;
        }
        .week-day-events {
            padding: 0 15px 12px;
        }
        .week-event-item {
            display: flex;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .week-event-item:last-child {
            border-bottom: none;
        }
        .week-event-time {
            font-size: 13px;
            color: #d4af37;
            min-width: 70px;
        }
        .week-event-title {
            font-size: 14px;
            color: rgba(255,255,255,0.9);
        }
        .week-no-events {
            padding: 8px 0;
            color: rgba(255,255,255,0.3);
            font-style: italic;
            font-size: 13px;
        }
        
        .calendar-view {
            width: 100%;
            height: 100%;
            padding: 24px;
            display: flex;
            flex-direction: column;
        }
        
        .calendar-view-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .calendar-view-header h2 {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .calendar-nav-btns {
            display: flex;
            gap: 8px;
        }
        
        .calendar-nav-btn {
            background: rgba(212,175,55,0.1);
            border: 1px solid rgba(212,175,55,0.3);
            color: #d4af37;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .calendar-nav-btn:hover {
            background: rgba(212,175,55,0.2);
        }
        
        .calendar-full-grid {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: auto repeat(6, 1fr);
            gap: 4px;
            max-height: calc(100vh - 200px);
        }
        
        .calendar-day-label {
            text-align: center;
            padding: 12px;
            font-weight: 600;
            color: #d4af37;
            font-size: 0.85rem;
        }
        
        .calendar-cell {
            background: rgba(0,0,0,0.2);
            border: 1px solid rgba(212,175,55,0.1);
            border-radius: 8px;
            padding: 8px;
            min-height: 80px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .calendar-cell:hover {
            background: rgba(212,175,55,0.05);
            border-color: rgba(212,175,55,0.3);
        }
        
        .calendar-cell.other-month {
            opacity: 0.3;
        }
        
        .calendar-cell.today {
            border-color: #d4af37;
            background: rgba(212,175,55,0.1);
        }
        
        .calendar-cell-date {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .calendar-cell.today .calendar-cell-date {
            color: #d4af37;
        }
        
        .calendar-event {
            background: linear-gradient(135deg, #d4af37, #b8960c);
            color: #000;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-top: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* ===== PEOPLE VIEW ===== */
        .people-view {
            width: 100%;
            height: 100%;
            padding: 24px;
            display: flex;
            flex-direction: column;
        }
        
        .people-view-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .people-view-header h2 {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .add-person-btn-large {
            display: flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #d4af37, #b8960c);
            border: none;
            color: #000;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .add-person-btn-large:hover {
            opacity: 0.9;
        }
        
        .people-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            overflow-y: auto;
            flex: 1;
        }
        
        .person-card-large {
            background: rgba(0,0,0,0.25);
            border: 1px solid rgba(212,175,55,0.15);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.2s;
        }
        
        .person-card-large:hover {
            border-color: rgba(212,175,55,0.4);
            transform: translateY(-2px);
        }
        
        .person-card-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }
        
        .person-avatar-large {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #d4af37, #b8960c);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.3rem;
            color: #000;
            flex-shrink: 0;
        }
        
        .person-card-info h3 {
            font-size: 1.1rem;
            margin-bottom: 4px;
        }
        
        .person-card-role {
            color: rgba(255,255,255,0.5);
            font-size: 0.85rem;
        }
        
        .person-card-actions {
            margin-left: auto;
            display: flex;
            gap: 8px;
        }
        
        .person-action-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.6);
            width: 32px;
            height: 32px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .person-action-btn:hover {
            background: rgba(212,175,55,0.1);
            border-color: rgba(212,175,55,0.3);
            color: #d4af37;
        }
        
        .person-action-btn.delete:hover {
            background: rgba(255,100,100,0.1);
            border-color: rgba(255,100,100,0.3);
            color: #ff6464;
        }
        
        .person-contact-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .person-contact-item-large {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
        }
        
        .person-contact-icon {
            font-size: 1rem;
        }
        
        .person-contact-value {
            font-size: 0.85rem;
        }
        
        .person-contact-value a {
            color: #d4af37;
            text-decoration: none;
        }
        
        .person-contact-value a:hover {
            text-decoration: underline;
        }
        
        .person-description-large {
            background: rgba(0,0,0,0.3);
            border-left: 3px solid #d4af37;
            padding: 14px 16px;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
            color: rgba(255,255,255,0.7);
            line-height: 1.6;
            font-style: italic;
        }
        
        .person-description-label {
            font-size: 0.75rem;
            color: #d4af37;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            font-style: normal;
        }
        
        /* Empty state */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: rgba(255,255,255,0.4);
        }
        
        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 16px;
        }
        
        .empty-state h3 {
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: rgba(255,255,255,0.6);
        }
        
        .empty-state p {
            font-size: 0.9rem;
            max-width: 400px;
            text-align: center;
            line-height: 1.5;
        }
        
        /* Modal styles */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 1px solid rgba(212,175,55,0.3);
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s;
        }
        
        .modal-overlay.active .modal {
            transform: scale(1);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 24px;
            border-bottom: 1px solid rgba(212,175,55,0.2);
        }
        
        .modal-header h2 {
            font-size: 1.25rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: rgba(255,255,255,0.6);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }
        
        .modal-close:hover {
            color: #fff;
        }
        
        .modal-body {
            padding: 24px;
        }
        
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid rgba(212,175,55,0.2);
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            border: 1px solid rgba(212,175,55,0.3);
            background: rgba(212,175,55,0.1);
            color: #d4af37;
            font-weight: 500;
        }
        
        .modal-btn:hover {
            background: rgba(212,175,55,0.2);
        }
        
        .modal-btn-primary {
            background: linear-gradient(135deg, #d4af37, #b8960c);
            color: #000;
            border: none;
        }
        
        .modal-btn-primary:hover {
            opacity: 0.9;
        }
        
        /* Form styles */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group:last-child {
            margin-bottom: 0;
        }
        
        .form-group label {
            display: block;
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
            margin-bottom: 8px;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(212,175,55,0.2);
            border-radius: 10px;
            padding: 12px 16px;
            color: #fff;
            font-size: 0.95rem;
            font-family: inherit;
            transition: border-color 0.2s;
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #d4af37;
        }
        
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-hint {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.4);
            margin-top: 6px;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .beta-banner {
                font-size: 0.85rem;
                padding: 10px 16px;
                padding-top: max(10px, env(safe-area-inset-top));
            }
            
            .stats-bar {
                padding: 10px 16px;
                gap: 12px;
            }
            
            .stats-bar .logo {
                font-size: 0.95rem;
                gap: 8px;
            }
            
            .stats-bar .logo .bot-avatar {
                width: 28px;
                height: 28px;
            }
            
            .view-selector-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .stats-items { display: none; }
            
            .upgrade-btn {
                padding: 6px 12px;
                font-size: 0.75rem;
            }
            
            .main-container { 
                flex-direction: column;
                height: auto;
                min-height: calc(100vh - 110px);
            }
            
            .stewart-area { 
                border-right: none; 
                border-bottom: 1px solid rgba(212,175,55,0.1);
                padding: 16px;
                min-height: auto;
            }
            
            .stewart-header {
                gap: 12px;
                margin-bottom: 16px;
            }
            
            .stewart-avatar {
                width: 60px;
                height: 60px;
            }
            
            .stewart-info h1 {
                font-size: 1.2rem;
            }
            
            .stewart-info p {
                font-size: 0.8rem;
            }
            
            .customize-btn {
                padding: 6px 12px;
                font-size: 0.75rem;
            }
            
            .chat-area {
                padding: 14px;
            }
            
            .quick-actions {
                gap: 6px;
                padding-top: 12px;
                margin-top: 12px;
            }
            
            .quick-action {
                padding: 6px 10px;
                font-size: 0.7rem;
            }
            
            .cards-sidebar { 
                max-height: 40vh;
                padding: 12px;
                gap: 12px;
            }
            
            .card-header {
                padding: 12px 14px;
            }
            
            .card-header h3 {
                font-size: 0.9rem;
            }
            
            .people-grid { 
                grid-template-columns: 1fr;
                gap: 14px;
            }
            
            .person-card-large {
                padding: 16px;
            }
            
            .person-contact-grid { grid-template-columns: 1fr; }
            
            .calendar-full-grid {
                max-height: calc(100vh - 250px);
            }
            
            .calendar-cell {
                min-height: 60px;
                padding: 6px;
            }
            
            .calendar-day-label {
                padding: 8px;
                font-size: 0.75rem;
            }
        }
        
        /* Extra small devices */
        @media (max-width: 400px) {
            .beta-banner {
                font-size: 0.75rem;
                padding: 8px 12px;
            }
            
            .stats-bar {
                padding: 8px 12px;
            }
            
            .stats-bar .logo {
                font-size: 0.85rem;
            }
            
            .view-selector-btn {
                padding: 5px 10px;
                font-size: 0.75rem;
            }
            
            .stewart-avatar {
                width: 50px;
                height: 50px;
            }
            
            .stewart-info h1 {
                font-size: 1rem;
            }
            
            .quick-action {
                font-size: 0.65rem;
            }
        }
    </style>
</head>
<body>
    <!-- Beta Banner -->
    <div class="beta-banner">
        üöÄ <strong>FULL BETA</strong> ‚Äî Some features may be intermittent. Thanks for helping us build the future!
    </div>
    
    <!-- Stats Bar -->
    <div class="stats-bar">
        <div class="logo">
            <div class="bot-avatar" id="navBotAvatar"></div>
            <span id="navBotName">Stewart</span>
        </div>
        
        <!-- View Selector -->
        <div class="view-selector" id="viewSelector">
            <button class="view-selector-btn" onclick="toggleViewDropdown()">
                <span id="currentViewIcon">üí¨</span>
                <span id="currentViewLabel">Chat</span>
                <span class="arrow">‚ñº</span>
            </button>
            <div class="view-dropdown">
                <div class="view-option active" data-view="chat" onclick="switchView('chat')">
                    <span class="icon">üí¨</span>
                    <span>Chat with Stewart</span>
                </div>
                <div class="view-option" data-view="calendar" onclick="switchView('calendar')">
                    <span class="icon">üìÜ</span>
                    <span>Calendar</span>
                </div>
                <div class="view-option" data-view="people" onclick="switchView('people')">
                    <span class="icon">üë•</span>
                    <span>People</span>
                </div>
            </div>
        </div>
        
        <div class="stats-items">
            <div class="stat-item">
                <div class="stat-value">12</div>
                <div class="stat-label">Trial Days</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">47</div>
                <div class="stat-label">Tasks Done</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">18h</div>
                <div class="stat-label">Hours Saved</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">2.3</div>
                <div class="stat-label">Stewdays Used</div>
            </div>
        </div>
        <button class="upgrade-btn">Upgrade</button>
    </div>
    
    <div class="main-container">
        <!-- CHAT VIEW -->
        <div class="view-container active" id="chatView">
            <!-- Stewart Area -->
            <div class="stewart-area">
                <div class="stewart-header">
                    <div class="stewart-avatar" onclick="openCustomizeModal()">
                        <div class="stewart-avatar-inner" id="mainBotAvatar"></div>
                    </div>
                    <div class="stewart-info">
                        <h1 id="botDisplayName">Stewart</h1>
                        <p>Your AI Business Partner</p>
                    </div>
                    <button class="customize-btn" onclick="openCustomizeModal()">Customize</button>
                </div>
                
                <div class="chat-area">
                    <div class="messages" id="messages">
                        <div class="message bot">
                            <div class="message-bubble">
                                Good morning! I've reviewed your schedule and prepared your daily briefing. You have 3 meetings today, including an important client call at 2 PM. Your top priority task is preparing the demo for Friday.
                            </div>
                        </div>
                    </div>
                    <div class="quick-actions">
                        <button class="quick-action">üìÖ What's on my schedule?</button>
                        <button class="quick-action">üìß Check my emails</button>
                        <button class="quick-action">‚úÖ Show my tasks</button>
                        <button class="quick-action">üìä Project status</button>
                    </div>
                </div>
            </div>
            
            <!-- Cards Sidebar -->
            <div class="cards-sidebar">
                <div class="card expanded">
                    <div class="card-header" onclick="toggleCard(this)">
                        <h3>üìÖ Today's Schedule</h3>
                        <span class="card-toggle">‚ñº</span>
                    </div>
                    <div class="card-content">
                        <div class="card-inner">
                            <div class="schedule-item">
                                <span class="schedule-time">9:00 AM</span>
                                <span class="schedule-title">‚úì Team standup</span>
                            </div>
                            <div class="schedule-item">
                                <span class="schedule-time">11:30 AM</span>
                                <span class="schedule-title">‚úì Review Q4 projections</span>
                            </div>
                            <div class="schedule-item current">
                                <span class="schedule-time">2:00 PM</span>
                                <span class="schedule-title">Client call - Acme Corp</span>
                            </div>
                            <div class="schedule-item">
                                <span class="schedule-time">4:30 PM</span>
                                <span class="schedule-title">Product roadmap review</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header" onclick="toggleCard(this)">
                        <h3>üìä Projects</h3>
                        <span class="card-toggle">‚ñº</span>
                    </div>
                    <div class="card-content">
                        <div class="card-inner">
                            <div class="project-item">
                                <div class="project-header">
                                    <span class="project-name">Website Redesign</span>
                                    <span class="project-progress">85%</span>
                                </div>
                                <div class="progress-bar"><div class="progress-fill" style="width: 85%"></div></div>
                            </div>
                            <div class="project-item">
                                <div class="project-header">
                                    <span class="project-name">Mobile App v2</span>
                                    <span class="project-progress">62%</span>
                                </div>
                                <div class="progress-bar"><div class="progress-fill" style="width: 62%"></div></div>
                            </div>
                            <div class="project-item">
                                <div class="project-header">
                                    <span class="project-name">API Integration</span>
                                    <span class="project-progress">34%</span>
                                </div>
                                <div class="progress-bar"><div class="progress-fill" style="width: 34%"></div></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header" onclick="toggleCard(this)">
                        <h3>‚úì Tasks</h3>
                        <span class="card-toggle">‚ñº</span>
                    </div>
                    <div class="card-content">
                        <div class="card-inner">
                            <div class="task-item">
                                <div class="task-checkbox checked"></div>
                                <span class="task-text completed">Review PR #234</span>
                            </div>
                            <div class="task-item">
                                <div class="task-checkbox checked"></div>
                                <span class="task-text completed">Send invoice to client</span>
                            </div>
                            <div class="task-item">
                                <div class="task-checkbox"></div>
                                <span class="task-text">Prepare demo for Friday</span>
                            </div>
                            <div class="task-item">
                                <div class="task-checkbox"></div>
                                <span class="task-text">Update documentation</span>
                            </div>
                            <div class="task-item">
                                <div class="task-checkbox"></div>
                                <span class="task-text">Schedule 1:1 meetings</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header" onclick="toggleCard(this)">
                        <h3>üîî Activity</h3>
                        <span class="card-toggle">‚ñº</span>
                    </div>
                    <div class="card-content">
                        <div class="card-inner">
                            <div class="activity-item">
                                <div class="activity-icon">üìß</div>
                                <div class="activity-content">
                                    <div class="activity-text">Replied to Sarah's email</div>
                                    <div class="activity-time">10 min ago</div>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">üìÑ</div>
                                <div class="activity-content">
                                    <div class="activity-text">Updated project timeline</div>
                                    <div class="activity-time">1 hour ago</div>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">üé§</div>
                                <div class="activity-content">
                                    <div class="activity-text">Transcribed meeting notes</div>
                                    <div class="activity-time">2 hours ago</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CALENDAR VIEW -->
        <div class="view-container" id="calendarView">
            <div class="calendar-view">
                <div class="calendar-view-header">
                    <h2>üìÜ Calendar</h2>
                    <div class="calendar-tabs">
                        <button class="cal-tab active" data-calview="today" onclick="switchCalendarTab('today')">Today</button>
                        <button class="cal-tab" data-calview="week" onclick="switchCalendarTab('week')">Week</button>
                        <button class="cal-tab" data-calview="month" onclick="switchCalendarTab('month')">Month</button>
                    </div>
                </div>
                
                <!-- TODAY TAB -->
                <div class="cal-tab-content active" id="calTodayTab">
                    <div class="today-banner">
                        <span class="today-day" id="todayDayName">Thursday</span>
                        <span class="today-full" id="todayFullDate">February 5, 2026</span>
                    </div>
                    <div class="today-events-list" id="todayEventsList">
                        <!-- Events rendered by JS -->
                    </div>
                    <div class="no-events-message" id="noTodayEvents" style="display:none;">
                        <span>üéâ</span>
                        <p>No events scheduled for today</p>
                    </div>
                </div>
                
                <!-- WEEK TAB -->
                <div class="cal-tab-content" id="calWeekTab">
                    <div class="week-nav">
                        <button class="week-nav-btn" onclick="changeWeek(-1)">‚Üê Previous</button>
                        <span id="weekRangeLabel">Feb 3 - Feb 9, 2026</span>
                        <button class="week-nav-btn" onclick="changeWeek(1)">Next ‚Üí</button>
                    </div>
                    <div class="week-grid" id="weekGrid">
                        <!-- Week days rendered by JS -->
                    </div>
                </div>
                
                <!-- MONTH TAB -->
                <div class="cal-tab-content" id="calMonthTab">
                    <div class="calendar-nav-btns">
                        <button class="calendar-nav-btn" onclick="changeCalendarMonth(-1)">‚Üê Previous</button>
                        <span id="calendarMonthYear">February 2026</span>
                        <button class="calendar-nav-btn" onclick="changeCalendarMonth(1)">Next ‚Üí</button>
                    </div>
                    <div class="calendar-full-grid" id="calendarFullGrid">
                        <!-- Calendar will be rendered by JS -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- PEOPLE VIEW -->
        <div class="view-container" id="peopleView">
            <div class="people-view">
                <div class="people-view-header">
                    <h2>üë• Important People</h2>
                    <button class="add-person-btn-large" onclick="openAddPersonModal()">
                        <span>+</span> Add Person
                    </button>
                </div>
                <div class="people-grid" id="peopleGrid">
                    <!-- People cards will be rendered by JS -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Input Bar -->
    <div class="input-bar">
        <div class="input-container">
            <input type="text" class="input-field" placeholder="Ask Stewart anything..." id="messageInput" onkeypress="handleKeyPress(event)">
            <button class="voice-btn" onclick="toggleVoice()">üé§</button>
        </div>
    </div>
    
    <!-- Add Person Modal -->
    <div class="modal-overlay" id="addPersonModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="personModalTitle">Add Important Person</h2>
                <button class="modal-close" onclick="closeAddPersonModal()">√ó</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editPersonId">
                <div class="form-group">
                    <label>Name *</label>
                    <input type="text" id="personName" placeholder="e.g., Suzy Johnson" required>
                </div>
                <div class="form-group">
                    <label>Role / Title</label>
                    <input type="text" id="personRole" placeholder="e.g., Shipping Manager">
                </div>
                <div class="form-group">
                    <label>Phone</label>
                    <input type="tel" id="personPhone" placeholder="e.g., +1 (555) 123-4567">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="personEmail" placeholder="e.g., suzy@company.com">
                </div>
                <div class="form-group">
                    <label>Description / Communication Style</label>
                    <textarea id="personDescription" placeholder="How should Stewart interact with this person? Include their personality, preferences, communication style, and what they care about.

Example: Suzy is in charge of shipping. She's really nice and always likes to make jokes. Keep conversations light and friendly - she appreciates humor."></textarea>
                    <div class="form-hint">This helps Stewart understand how to communicate with this person - whether they prefer brief updates or detailed explanations, humor or just facts, etc.</div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn" onclick="closeAddPersonModal()">Cancel</button>
                <button class="modal-btn modal-btn-primary" onclick="savePerson()">Save Person</button>
            </div>
        </div>
    </div>
    
    <!-- Customize Bot Modal (simplified - keeping from v4) -->
    <div class="modal-overlay" id="customizeModal">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <h2>Customize Your Assistant</h2>
                <button class="modal-close" onclick="closeCustomizeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p style="text-align: center; color: rgba(255,255,255,0.6);">Avatar customization coming soon...</p>
            </div>
        </div>
    </div>

    <script>
        // ===== VIEW SWITCHING =====
        let currentView = 'chat';
        
        function toggleViewDropdown() {
            document.getElementById('viewSelector').classList.toggle('open');
        }
        
        function switchView(view) {
            currentView = view;
            
            // Update dropdown
            document.getElementById('viewSelector').classList.remove('open');
            document.querySelectorAll('.view-option').forEach(opt => opt.classList.remove('active'));
            document.querySelector(`.view-option[data-view="${view}"]`).classList.add('active');
            
            // Update button label
            const labels = { chat: 'Chat', calendar: 'Calendar', people: 'People' };
            const icons = { chat: 'üí¨', calendar: 'üìÜ', people: 'üë•' };
            document.getElementById('currentViewLabel').textContent = labels[view];
            document.getElementById('currentViewIcon').textContent = icons[view];
            
            // Show/hide views
            document.querySelectorAll('.view-container').forEach(v => v.classList.remove('active'));
            document.getElementById(view + 'View').classList.add('active');
            
            // Render content if needed
            if (view === 'calendar') renderTodayView();
            if (view === 'people') renderPeopleGrid();
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.view-selector')) {
                document.getElementById('viewSelector').classList.remove('open');
            }
        });
        
        // ===== CALENDAR =====
        let calendarDate = new Date();
        const calendarEvents = [
            { date: '2026-02-05', title: 'Client meeting', time: '2:00 PM' },
            { date: '2026-02-10', title: 'Team standup', time: '9:00 AM' },
            { date: '2026-02-14', title: "Valentine's Day", time: 'All day' },
            { date: '2026-02-20', title: 'Product launch', time: '10:00 AM' },
            { date: '2026-02-25', title: 'Board presentation', time: '3:00 PM' },
        ];
        
        function renderFullCalendar() {
            const grid = document.getElementById('calendarFullGrid');
            const year = calendarDate.getFullYear();
            const month = calendarDate.getMonth();
            
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                               'July', 'August', 'September', 'October', 'November', 'December'];
            document.getElementById('calendarMonthYear').textContent = `${monthNames[month]} ${year}`;
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDay = firstDay.getDay();
            const totalDays = lastDay.getDate();
            
            const today = new Date();
            const todayStr = `${today.getFullYear()}-${String(today.getMonth()+1).padStart(2,'0')}-${String(today.getDate()).padStart(2,'0')}`;
            
            let html = '';
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            days.forEach(d => html += `<div class="calendar-day-label">${d}</div>`);
            
            // Previous month
            const prevMonth = new Date(year, month, 0);
            const prevMonthDays = prevMonth.getDate();
            for (let i = startDay - 1; i >= 0; i--) {
                html += `<div class="calendar-cell other-month"><div class="calendar-cell-date">${prevMonthDays - i}</div></div>`;
            }
            
            // Current month
            for (let day = 1; day <= totalDays; day++) {
                const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`;
                const isToday = dateStr === todayStr;
                const dayEvents = calendarEvents.filter(e => e.date === dateStr);
                
                let cellClass = 'calendar-cell';
                if (isToday) cellClass += ' today';
                
                let eventsHtml = dayEvents.map(e => 
                    `<div class="calendar-event" title="${e.time}: ${e.title}">${e.title}</div>`
                ).join('');
                
                html += `<div class="${cellClass}" onclick="showDayDetail('${dateStr}')">
                    <div class="calendar-cell-date">${day}</div>
                    ${eventsHtml}
                </div>`;
            }
            
            // Next month
            const remainingCells = 42 - (startDay + totalDays);
            for (let i = 1; i <= remainingCells; i++) {
                html += `<div class="calendar-cell other-month"><div class="calendar-cell-date">${i}</div></div>`;
            }
            
            grid.innerHTML = html;
        }
        
        function changeCalendarMonth(delta) {
            calendarDate.setMonth(calendarDate.getMonth() + delta);
            renderFullCalendar();
        }
        
        function goToToday() {
            calendarDate = new Date();
            renderFullCalendar();
        }
        
        function showDayDetail(dateStr) {
            const events = calendarEvents.filter(e => e.date === dateStr);
            if (events.length > 0) {
                alert(`Events on ${dateStr}:\n\n${events.map(e => `${e.time}: ${e.title}`).join('\n')}`);
            }
        }
        
        // Calendar Tab Switching
        function switchCalendarTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.cal-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`.cal-tab[data-calview="${tabName}"]`).classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.cal-tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(`cal${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`).classList.add('active');
            
            // Render appropriate view
            if (tabName === 'today') renderTodayView();
            else if (tabName === 'week') renderWeekView();
            else if (tabName === 'month') renderFullCalendar();
        }
        
        // Today View
        function renderTodayView() {
            const today = new Date();
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                           'July', 'August', 'September', 'October', 'November', 'December'];
            
            document.getElementById('todayDayName').textContent = days[today.getDay()];
            document.getElementById('todayFullDate').textContent = `${months[today.getMonth()]} ${today.getDate()}, ${today.getFullYear()}`;
            
            const todayStr = `${today.getFullYear()}-${String(today.getMonth()+1).padStart(2,'0')}-${String(today.getDate()).padStart(2,'0')}`;
            const todaysEvents = calendarEvents.filter(e => e.date === todayStr);
            
            const list = document.getElementById('todayEventsList');
            const noEvents = document.getElementById('noTodayEvents');
            
            if (todaysEvents.length === 0) {
                list.innerHTML = '';
                noEvents.style.display = 'block';
            } else {
                noEvents.style.display = 'none';
                list.innerHTML = todaysEvents.map(e => {
                    const timeParts = e.time.match(/(\d+):?(\d*)\s*(AM|PM|am|pm)?/);
                    let hour = timeParts ? timeParts[1] : '';
                    let min = timeParts && timeParts[2] ? ':' + timeParts[2] : '';
                    let ampm = timeParts && timeParts[3] ? timeParts[3].toUpperCase() : '';
                    if (e.time === 'All day') { hour = ''; ampm = 'All day'; }
                    
                    return `<div class="today-event-card">
                        <div class="event-time-block">
                            <div class="event-time">${hour}${min}</div>
                            <div class="event-ampm">${ampm}</div>
                        </div>
                        <div class="event-details">
                            <div class="event-title-main">${e.title}</div>
                            <div class="event-meta">${e.time}</div>
                        </div>
                    </div>`;
                }).join('');
            }
        }
        
        // Week View
        let weekStartDate = new Date();
        weekStartDate.setDate(weekStartDate.getDate() - weekStartDate.getDay()); // Start of current week (Sunday)
        
        function renderWeekView() {
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            
            const today = new Date();
            const todayStr = `${today.getFullYear()}-${String(today.getMonth()+1).padStart(2,'0')}-${String(today.getDate()).padStart(2,'0')}`;
            
            // Week range label
            const weekEnd = new Date(weekStartDate);
            weekEnd.setDate(weekEnd.getDate() + 6);
            document.getElementById('weekRangeLabel').textContent = 
                `${months[weekStartDate.getMonth()]} ${weekStartDate.getDate()} - ${months[weekEnd.getMonth()]} ${weekEnd.getDate()}, ${weekStartDate.getFullYear()}`;
            
            // Build week grid
            let html = '';
            for (let i = 0; i < 7; i++) {
                const day = new Date(weekStartDate);
                day.setDate(day.getDate() + i);
                const dateStr = `${day.getFullYear()}-${String(day.getMonth()+1).padStart(2,'0')}-${String(day.getDate()).padStart(2,'0')}`;
                const isToday = dateStr === todayStr;
                const dayEvents = calendarEvents.filter(e => e.date === dateStr);
                
                let eventsHtml = dayEvents.length > 0 
                    ? dayEvents.map(e => `<div class="week-event-item"><span class="week-event-time">${e.time}</span><span class="week-event-title">${e.title}</span></div>`).join('')
                    : '<div class="week-no-events">No events</div>';
                
                html += `<div class="week-day-row${isToday ? ' today' : ''}">
                    <div class="week-day-header">
                        <span class="week-day-name">${days[i]}${isToday ? ' (Today)' : ''}</span>
                        <span class="week-day-date">${months[day.getMonth()]} ${day.getDate()}</span>
                    </div>
                    <div class="week-day-events">${eventsHtml}</div>
                </div>`;
            }
            document.getElementById('weekGrid').innerHTML = html;
        }
        
        function changeWeek(delta) {
            weekStartDate.setDate(weekStartDate.getDate() + (delta * 7));
            renderWeekView();
        }
        
        // ===== PEOPLE =====
        let people = [
            {
                id: 1,
                name: 'Suzy Johnson',
                role: 'Shipping Manager',
                phone: '+1 (555) 234-5678',
                email: 'suzy@company.com',
                description: "Suzy is in charge of shipping. She's really nice and always likes to make jokes. Keep conversations light and friendly - she appreciates humor and doesn't like overly formal communication. Always start with a friendly greeting."
            },
            {
                id: 2,
                name: 'Alan Chen',
                role: 'IT Director',
                phone: '+1 (555) 345-6789',
                email: 'alan@company.com',
                description: "Alan is in IT. He is very serious and wants just the information pertinent to the task at hand. He doesn't want long stories about how things came about and definitely doesn't want to chit chat or joke around. Be direct, technical, and concise."
            }
        ];
        
        function renderPeopleGrid() {
            const grid = document.getElementById('peopleGrid');
            
            if (people.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-state-icon">üë•</div>
                        <h3>No people added yet</h3>
                        <p>Add important contacts so Stewart knows how to communicate with them. Include personality notes, communication preferences, and key details.</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = people.map(person => `
                <div class="person-card-large">
                    <div class="person-card-header">
                        <div class="person-avatar-large">${getInitials(person.name)}</div>
                        <div class="person-card-info">
                            <h3>${person.name}</h3>
                            ${person.role ? `<div class="person-card-role">${person.role}</div>` : ''}
                        </div>
                        <div class="person-card-actions">
                            <button class="person-action-btn" onclick="editPerson(${person.id})" title="Edit">‚úèÔ∏è</button>
                            <button class="person-action-btn delete" onclick="deletePerson(${person.id})" title="Delete">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="person-contact-grid">
                        ${person.phone ? `
                            <div class="person-contact-item-large">
                                <span class="person-contact-icon">üì±</span>
                                <span class="person-contact-value"><a href="tel:${person.phone}">${person.phone}</a></span>
                            </div>
                        ` : ''}
                        ${person.email ? `
                            <div class="person-contact-item-large">
                                <span class="person-contact-icon">‚úâÔ∏è</span>
                                <span class="person-contact-value"><a href="mailto:${person.email}">${person.email}</a></span>
                            </div>
                        ` : ''}
                    </div>
                    ${person.description ? `
                        <div class="person-description-large">
                            <div class="person-description-label">Communication Style</div>
                            ${person.description}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }
        
        function getInitials(name) {
            return name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2);
        }
        
        function openAddPersonModal() {
            document.getElementById('personModalTitle').textContent = 'Add Important Person';
            document.getElementById('editPersonId').value = '';
            document.getElementById('personName').value = '';
            document.getElementById('personRole').value = '';
            document.getElementById('personPhone').value = '';
            document.getElementById('personEmail').value = '';
            document.getElementById('personDescription').value = '';
            document.getElementById('addPersonModal').classList.add('active');
        }
        
        function closeAddPersonModal() {
            document.getElementById('addPersonModal').classList.remove('active');
        }
        
        function editPerson(id) {
            const person = people.find(p => p.id === id);
            if (!person) return;
            
            document.getElementById('personModalTitle').textContent = 'Edit Person';
            document.getElementById('editPersonId').value = id;
            document.getElementById('personName').value = person.name;
            document.getElementById('personRole').value = person.role || '';
            document.getElementById('personPhone').value = person.phone || '';
            document.getElementById('personEmail').value = person.email || '';
            document.getElementById('personDescription').value = person.description || '';
            document.getElementById('addPersonModal').classList.add('active');
        }
        
        function savePerson() {
            const id = document.getElementById('editPersonId').value;
            const name = document.getElementById('personName').value.trim();
            
            if (!name) {
                alert('Please enter a name');
                return;
            }
            
            const personData = {
                id: id ? parseInt(id) : Date.now(),
                name: name,
                role: document.getElementById('personRole').value.trim(),
                phone: document.getElementById('personPhone').value.trim(),
                email: document.getElementById('personEmail').value.trim(),
                description: document.getElementById('personDescription').value.trim()
            };
            
            if (id) {
                // Update existing
                const index = people.findIndex(p => p.id === parseInt(id));
                if (index >= 0) people[index] = personData;
            } else {
                // Add new
                people.push(personData);
            }
            
            savePeopleToStorage();
            renderPeopleGrid();
            closeAddPersonModal();
            
            // Show confirmation in chat
            addMessage(`Got it! I've ${id ? 'updated' : 'added'} ${name} to your contacts. I'll remember how to communicate with them.`, 'bot');
        }
        
        function deletePerson(id) {
            const person = people.find(p => p.id === id);
            if (confirm(`Remove ${person.name} from your contacts?`)) {
                people = people.filter(p => p.id !== id);
                savePeopleToStorage();
                renderPeopleGrid();
            }
        }
        
        function savePeopleToStorage() {
            localStorage.setItem('stewartPeople', JSON.stringify(people));
        }
        
        function loadPeopleFromStorage() {
            const stored = localStorage.getItem('stewartPeople');
            if (stored) {
                people = JSON.parse(stored);
            }
        }
        
        // ===== CHAT =====
        function addMessage(text, type) {
            const messages = document.getElementById('messages');
            const msg = document.createElement('div');
            msg.className = `message ${type}`;
            msg.innerHTML = `<div class="message-bubble">${text}</div>`;
            messages.appendChild(msg);
            messages.scrollTop = messages.scrollHeight;
        }
        
        function handleKeyPress(e) {
            if (e.key === 'Enter') {
                const input = document.getElementById('messageInput');
                const text = input.value.trim();
                if (text) {
                    addMessage(text, 'user');
                    input.value = '';
                    // Simulate response
                    setTimeout(() => {
                        addMessage("I'm processing your request...", 'bot');
                    }, 500);
                }
            }
        }
        
        function toggleVoice() {
            alert('Voice input coming soon!');
        }
        
        // ===== CARDS =====
        function toggleCard(header) {
            const card = header.parentElement;
            card.classList.toggle('expanded');
        }
        
        // ===== CUSTOMIZE MODAL =====
        function openCustomizeModal() {
            document.getElementById('customizeModal').classList.add('active');
        }
        
        function closeCustomizeModal() {
            document.getElementById('customizeModal').classList.remove('active');
        }
        
        // ===== INIT =====
        function initAvatar() {
            const config = {
                skinColor: 'light',
                topType: 'shortHairShortFlat',
                hairColor: 'brown',
                facialHairType: 'blank',
                clotheType: 'blazerSweater',
                clotheColor: 'black',
                eyeType: 'default',
                eyebrowType: 'default',
                mouthType: 'smile',
                accessoriesType: 'blank'
            };
            
            if (typeof generateAvatar === 'function') {
                const svg = generateAvatar(config);
                document.getElementById('mainBotAvatar').innerHTML = svg;
                document.getElementById('navBotAvatar').innerHTML = svg;
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadPeopleFromStorage();
            initAvatar();
            renderTodayView();
            renderWeekView();
            renderFullCalendar();
            renderPeopleGrid();
        });
    </script>
</body>
</html>
